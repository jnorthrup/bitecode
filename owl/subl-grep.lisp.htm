<code><span style="color: #000000">
(punless&nbsp;(fboundp&nbsp;'force-print)&nbsp;<br />&nbsp;&nbsp;(define&nbsp;force-print&nbsp;(&amp;rest&nbsp;body)&nbsp;(clet&nbsp;((body&nbsp;(fif&nbsp;(equal&nbsp;1&nbsp;(length&nbsp;body))&nbsp;(car&nbsp;body)&nbsp;body))(res&nbsp;(print&nbsp;body)))(force-output)(ret&nbsp;res))))<br />&nbsp;&nbsp;&nbsp;&nbsp;;;http://gothapedia.com/openCycCGI/cg?cb-subl-grep=&amp;SEARCH=PARS&amp;ARGS=&amp;DO=GREP&amp;STARTCOUNT=0&amp;MAXDISPLAYCOUNT=1600&amp;FUNCTIONS=FUNCTIONS&amp;MODULES=MODULES<br />&nbsp;&nbsp;&nbsp;&nbsp;;;http://gothapedia.com/openCycCGI/cg?cb-start|cb-subloop-class&amp;CLASS=PARSER<br />&nbsp;&nbsp;&nbsp;&nbsp;;;http://gothapedia.com/openCycCGI/cg?cb-start|cb-subloop-class&amp;CLASS=PARSER<br />;;(csetq&nbsp;*ERROR-MESSSAGE*&nbsp;"No&nbsp;error&nbsp;message")<br />(defmacro&nbsp;onerror-warn&nbsp;(message&nbsp;&amp;rest&nbsp;forms)&nbsp;(ret<br />&nbsp;&nbsp;&nbsp;&nbsp;`(with-error-handler<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#'(lambda&nbsp;(&amp;rest&nbsp;r)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;PRE&gt;&lt;font&nbsp;color=red&gt;~a&nbsp;~a&lt;/font&gt;~%&nbsp;in&nbsp;~a&nbsp;~a~&amp;&lt;/PRE&gt;"&nbsp;,message&nbsp;*ERROR-MESSSAGE*&nbsp;',forms&nbsp;r)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(force-output))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(progn&nbsp;,@forms))))<br /><br /><br />(defmacro&nbsp;or&nbsp;(&amp;rest&nbsp;body)&nbsp;(ret&nbsp;(fif&nbsp;body&nbsp;(fif&nbsp;(cdr&nbsp;body)&nbsp;`(pcond&nbsp;(,(car&nbsp;body))&nbsp;((or&nbsp;,@(cdr&nbsp;body))))`,(car&nbsp;body)))))<br />(defmacro&nbsp;and&nbsp;(&amp;rest&nbsp;body)&nbsp;(ret&nbsp;(fif&nbsp;body&nbsp;(fif&nbsp;(cdr&nbsp;body)&nbsp;`(pwhen&nbsp;,(car&nbsp;body)&nbsp;(and&nbsp;,@(cdr&nbsp;body)))`,(car&nbsp;body)))))<br />(defmacro&nbsp;not&nbsp;(&amp;rest&nbsp;body)&nbsp;(ret&nbsp;`(cnot&nbsp;,@body)))<br /><br />(define&nbsp;sym&lt;&nbsp;(a&nbsp;b)&nbsp;(ret&nbsp;(cand&nbsp;a&nbsp;b&nbsp;(string-lessp&nbsp;(write-to-string&nbsp;a)(write-to-string&nbsp;b)))))<br /><br />(define&nbsp;insert-sorted&nbsp;(item&nbsp;sortedset)<br />&nbsp;&nbsp;(punless&nbsp;item&nbsp;(ret&nbsp;sortedset))<br />&nbsp;&nbsp;(punless&nbsp;sortedset&nbsp;(ret&nbsp;(values&nbsp;(list&nbsp;item)&nbsp;(list&nbsp;item))))<br />&nbsp;(clet&nbsp;((e&nbsp;())&nbsp;c)<br />&nbsp;&nbsp;(cdo&nbsp;((d&nbsp;sortedset&nbsp;e)(c&nbsp;(car&nbsp;sortedset)(car&nbsp;d))(e&nbsp;(cdr&nbsp;d)(cdr&nbsp;d)))&nbsp;(())<br />&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(equal&nbsp;item&nbsp;c)&nbsp;(ret&nbsp;sortedset))<br />&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(sym&lt;&nbsp;item&nbsp;c)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rplacd&nbsp;d&nbsp;(cons&nbsp;c&nbsp;e))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rplaca&nbsp;d&nbsp;item)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ret&nbsp;(values&nbsp;sortedset&nbsp;d)))<br />&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(null&nbsp;e)&nbsp;(rplacd&nbsp;d&nbsp;(list&nbsp;item))(ret&nbsp;(values&nbsp;sortedset&nbsp;(cdr&nbsp;d)&nbsp;))))))<br /><br />(insert-sorted&nbsp;'A&nbsp;'(B&nbsp;C))<br /><br />(insert-sorted&nbsp;'C&nbsp;'(A&nbsp;B&nbsp;C))<br /><br />(insert-sorted&nbsp;'1&nbsp;'(A&nbsp;B&nbsp;C))<br /><br />(insert-sorted&nbsp;'D&nbsp;'(A&nbsp;B&nbsp;C))<br /><br />(defmacro&nbsp;push-sorted&nbsp;(item&nbsp;place)&nbsp;(ret&nbsp;<br />&nbsp;`(fif&nbsp;(null&nbsp;,place)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;,place&nbsp;(list&nbsp;,item))<br />&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;,item&nbsp;(second&nbsp;(multiple-value-list&nbsp;(csetq&nbsp;,place&nbsp;(insert-sorted&nbsp;,item&nbsp;,place))))))))<br /><br />#|<br />(csetq&nbsp;lotus-image&nbsp;(NEW-REMOTE-IMAGE&nbsp;"lotus"&nbsp;3614))<br />(csetq&nbsp;lotus-connection&nbsp;(NEW-REMOTE-IMAGE-CONNECTION&nbsp;&nbsp;lotus-image))<br />(REMOTE-IMAGE-CONNECTION-PORT&nbsp;lotus-connection)<br />(OPEN-REMOTE-IMAGE-CONNECTION&nbsp;lotus-connection)&nbsp;<br />(&nbsp;REMOTE-IMAGE-CONNECTION-IMAGE&nbsp;&nbsp;lotus-connection)&nbsp;<br />(csetq&nbsp;lotus-INTERSECTION&nbsp;(NEW-KB-INTERSECTION&nbsp;&nbsp;lotus-IMAGE))<br />(csetq&nbsp;lotus-INTERSECTION-result&nbsp;&nbsp;(KB-INTERSECTION-COMPUTE&nbsp;&nbsp;lotus-INTERSECTION))<br />(csetq&nbsp;lotus-DIFFERENCE-result&nbsp;(csetq&nbsp;lotus-DIFFERENCE&nbsp;(NEW-KB-DIFFERENCE&nbsp;&nbsp;&nbsp;&nbsp;lotus-IMAGE)))<br /><br />(csetq&nbsp;lotus-INTERSECTION-result&nbsp;(COMPUTE-REMOTE-IMAGE-KB-INTERSECTION&nbsp;"lotus"&nbsp;3614&nbsp;))<br /><br />(csetq&nbsp;lotus-DIFFERENCE-result&nbsp;(COMPUTE-REMOTE-IMAGE-KB-DIFFERENCE&nbsp;"lotus"&nbsp;3614&nbsp;))<br /><br />;;COMPUTE-REMOTE-IMAGE-KB-DIFFERENCE&nbsp;&nbsp;<br /><br />LOAD-JANUS-TRANSCRIPT&nbsp;&nbsp;<br /><br />SAVE-KBS-SPLICING-PARTITION&nbsp;&nbsp;<br /><br /><br />(define&nbsp;save-big-cpart&nbsp;(&amp;optional&nbsp;(&nbsp;filename&nbsp;(cconcatenate&nbsp;(KB-VERSION-STRING)&nbsp;".cpart")))<br />&nbsp;&nbsp;&nbsp;&nbsp;(CB-SET-PARTITION-SAVE-TERMS&nbsp;(all-constants))<br />&nbsp;&nbsp;&nbsp;&nbsp;(CB-PERFORM-PARTITION-SAVE&nbsp;&nbsp;filename&nbsp;part-save&nbsp;)))<br /><br />(defvar&nbsp;part-save&nbsp;())<br />(define&nbsp;save-big-cpart&nbsp;(&amp;optional&nbsp;(&nbsp;filename&nbsp;(cconcatenate&nbsp;(KB-VERSION-STRING)&nbsp;".cpart")))<br />&nbsp;&nbsp;(pwhen&nbsp;(CB-PARTITION-SAVE-P&nbsp;part-save)&nbsp;(ret&nbsp;parts-save))<br />&nbsp;&nbsp;(csetq&nbsp;part-save&nbsp;(MAKE-CB-PARTITION-SAVE))<br />&nbsp;&nbsp;(DO-FORTS&nbsp;(c)&nbsp;(CB-ADD-PARTITION-SAVE-TERM&nbsp;part-save&nbsp;c))<br />&nbsp;&nbsp;(CB-PERFORM-PARTITION-SAVE&nbsp;filename&nbsp;part-save))<br /><br />(csetq&nbsp;*fboundps*&nbsp;())(cdo-all-symbols&nbsp;(sym)&nbsp;(pwhen&nbsp;(sl::fboundp&nbsp;sym)&nbsp;(cpushnew&nbsp;sym&nbsp;*fboundps*)))(length&nbsp;*fboundps*)<br />&nbsp;&nbsp;&nbsp;(CB-PERFORM-PARTITION-SAVE&nbsp;"allmts"&nbsp;part-save)<br />&nbsp;&nbsp;&nbsp;&nbsp;(with-error-handler<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#'(lambda&nbsp;(&amp;rest&nbsp;r)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;PRE&gt;&lt;font&nbsp;color=red&gt;~a&nbsp;&lt;/font&gt;&lt;/PRE&gt;"&nbsp;*ERROR-MESSSAGE*&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(force-output))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(load-partition&nbsp;"titan-7116.cpart"))<br /><br />(defvar&nbsp;part-save&nbsp;())<br />(punless&nbsp;(CB-PARTITION-SAVE-P&nbsp;part-save)&nbsp;(csetq&nbsp;part-save&nbsp;(MAKE-CB-PARTITION-SAVE)))<br />(cdolist&nbsp;(mt&nbsp;(remove-duplicates&nbsp;(ask-template&nbsp;'?MT&nbsp;`(#$and&nbsp;(#$genls&nbsp;?C&nbsp;#$Microtheory)(#$nearestIsa&nbsp;?MT&nbsp;?C)&nbsp;)&nbsp;#$EverythingPSC)))<br />&nbsp;&nbsp;(CB-ADD-PARTITION-SAVE-TERM&nbsp;part-save&nbsp;mt))<br /><br /><br />(defvar&nbsp;part-save&nbsp;())<br />(punless&nbsp;(CB-PARTITION-SAVE-P&nbsp;part-save)&nbsp;(csetq&nbsp;part-save&nbsp;(MAKE-CB-PARTITION-SAVE)))<br />&nbsp;&nbsp;(cdolist&nbsp;(mt&nbsp;(remove-duplicates&nbsp;(all-instances&nbsp;#$Microtheory)))&nbsp;(CB-ADD-PARTITION-SAVE-TERM&nbsp;part-save&nbsp;mt))<br /><br /><br />&nbsp;(CB-ADD-PARTITION-SAVE-TERM&nbsp;part-save&nbsp;"all-mts.cpart")<br /><br />(define&nbsp;save-big-cpart&nbsp;(&amp;optional&nbsp;(&nbsp;filename&nbsp;(cconcatenate&nbsp;(KB-VERSION-STRING)&nbsp;".cpart")))<br />&nbsp;&nbsp;(clet&nbsp;((part-save&nbsp;(MAKE-CB-PARTITION-SAVE&nbsp;)))<br />&nbsp;&nbsp;&nbsp;(cdolist&nbsp;(mt&nbsp;(ask-template&nbsp;'?MT&nbsp;`(#$and&nbsp;(#$isa&nbsp;?MT&nbsp;?C)&nbsp;(#$genls&nbsp;?C&nbsp;#$Microtheory))&nbsp;#$EverythingPSC))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CB-ADD-PARTITION-SAVE-TERM&nbsp;part-save&nbsp;mt))<br />&nbsp;&nbsp;&nbsp;(CB-PERFORM-PARTITION-SAVE&nbsp;&nbsp;filename&nbsp;part-save&nbsp;)))<br /><br /><br />(defvar&nbsp;part-save&nbsp;())<br />(punless&nbsp;(CB-PARTITION-SAVE-P&nbsp;part-save)&nbsp;(csetq&nbsp;part-save&nbsp;(MAKE-CB-PARTITION-SAVE)))<br />(cdolist&nbsp;(mt&nbsp;'(#$isa&nbsp;#$genls&nbsp;#$comment&nbsp;#$genlMt&nbsp;#$Collection&nbsp;#$resultIsa&nbsp;#$termOfUnit))&nbsp;(CB-ADD-PARTITION-SAVE-TERM&nbsp;part-save&nbsp;mt))<br />(cdolist&nbsp;(mt&nbsp;(remove-duplicates&nbsp;(all-instances&nbsp;#$Microtheory)))&nbsp;(CB-ADD-PARTITION-SAVE-TERM&nbsp;part-save&nbsp;mt))<br />(CB-PERFORM-PARTITION-SAVE&nbsp;<br />&nbsp;&nbsp;(cconcatenate&nbsp;(fif&nbsp;(SL::GETENV&nbsp;"COMPUTERNAME")&nbsp;&nbsp;(SL::GETENV&nbsp;"COMPUTERNAME")&nbsp;(SL::GETENV&nbsp;"HOSTNAME")&nbsp;)&nbsp;"-"&nbsp;(KB-VERSION-STRING)&nbsp;".cpart")&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;part-save&nbsp;)<br /><br /><br />;;(assertion-count)&nbsp;2700397<br /><br />2700396<br /><br />(get-assertion-dependants<br />DO-ASSERTION-DEPENDENTS<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;<br /><br />(ke-assert-now&nbsp;`(#$implies&nbsp;(#$and&nbsp;(#$isa&nbsp;?MT&nbsp;?MTTYPE)(#$isa&nbsp;?MTTYPE&nbsp;#$MicrotheoryType))(#$isa&nbsp;?MT&nbsp;#$Microtheory))&nbsp;#$BaseKB&nbsp;&nbsp;:monotonic&nbsp;:FORWARD)<br />(ke-assert-now&nbsp;`(#$isa&nbsp;,(foc&nbsp;"MicrotheoryFunction")&nbsp;#$Collection)&nbsp;#$BaseKB)<br />(ke-assert-now&nbsp;`(#$genls&nbsp;,(foc&nbsp;"MicrotheoryFunction")&nbsp;#$IndividualDenotingFunction)&nbsp;#$BaseKB)<br />(ke-assert-now&nbsp;`(#$implies&nbsp;(#$genls&nbsp;?MTTYPE&nbsp;#$Microtheory)(#$isa&nbsp;?MTTYPE&nbsp;#$MicrotheoryType))&nbsp;#$BaseKB&nbsp;&nbsp;:default&nbsp;&nbsp;:forward)<br />(ke-assert-now&nbsp;`(#$implies&nbsp;(#$and&nbsp;(#$resultIsa&nbsp;?FUNCT&nbsp;?MTTYPE)(#$isa&nbsp;?MTTYPE&nbsp;#$MicrotheoryType))(#$isa&nbsp;?FUNCT&nbsp;#$MicrotheoryFunction))#$BaseKB&nbsp;:default&nbsp;&nbsp;:forward)<br />(ke-assert-now&nbsp;`(#$implies&nbsp;(#$isa&nbsp;?FUNCT&nbsp;#$MicrotheoryFunction)&nbsp;(#$resultIsa&nbsp;?FUNCT&nbsp;#$Microtheory))&nbsp;#$BaseKB&nbsp;:default&nbsp;&nbsp;:forward)<br /><br />(defvar&nbsp;part-save&nbsp;())<br />(punless&nbsp;(CB-PARTITION-SAVE-P&nbsp;part-save)&nbsp;(csetq&nbsp;part-save&nbsp;(MAKE-CB-PARTITION-SAVE)))<br />(length&nbsp;(all-instances&nbsp;#$Microtheory))<br />(cdolist&nbsp;(mt&nbsp;'(#$isa&nbsp;#$genls&nbsp;#$comment&nbsp;#$genlMt&nbsp;#$Collection&nbsp;#$resultIsa&nbsp;#$termOfUnit))&nbsp;(CB-ADD-PARTITION-SAVE-TERM&nbsp;part-save&nbsp;mt))<br />(DO-ASSERTION-DEPENDENT-ASSERTIONS&nbsp;(deps&nbsp;(find-assertion-by-id&nbsp;2700396))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CB-ADD-PARTITION-SAVE-TERM&nbsp;part-save&nbsp;(second&nbsp;(assertion-el-formula&nbsp;deps))))<br /><br /><br />(DO-ASSERTION-DEPENDENT-ASSERTIONS&nbsp;(deps&nbsp;(find-assertion-by-id&nbsp;2700396))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CB-ADD-PARTITION-SAVE-TERM&nbsp;&nbsp;(second&nbsp;(assertion-el-formula&nbsp;deps))))<br /><br />(cdolist&nbsp;(mt&nbsp;(remove-duplicates&nbsp;(all-instances&nbsp;#$Microtheory)))&nbsp;(CB-ADD-PARTITION-SAVE-TERM&nbsp;part-save&nbsp;mt))<br />(CB-PERFORM-PARTITION-SAVE&nbsp;<br />&nbsp;&nbsp;(cconcatenate&nbsp;(fif&nbsp;(SL::GETENV&nbsp;"COMPUTERNAME")&nbsp;&nbsp;(SL::GETENV&nbsp;"COMPUTERNAME")&nbsp;(SL::GETENV&nbsp;"HOSTNAME")&nbsp;)&nbsp;"-"&nbsp;(KB-VERSION-STRING)&nbsp;".cpart")&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;part-save&nbsp;)<br /><br /><br />(define&nbsp;translate-cfasl&nbsp;(&amp;optional&nbsp;(infile&nbsp;"units/7116/sbhl-modules.cfasl")&nbsp;(&nbsp;outfile&nbsp;(cconcatenate&nbsp;infile&nbsp;".text")))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;WITH-CFASL-STREAM-EXTENSIONS&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;(clet&nbsp;((istream&nbsp;(OPEN-BINARY&nbsp;infile&nbsp;:input))(ostream&nbsp;(fif&nbsp;(stringp&nbsp;outfile)(OPEN-TEXT&nbsp;outfile&nbsp;:output)(fif&nbsp;(streamp&nbsp;outfile)&nbsp;outfile&nbsp;*STANDARD-OUTPUT*))))<br />&nbsp;&nbsp;&nbsp;(cdo&nbsp;()&nbsp;()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(print&nbsp;(CFASL-INPUT&nbsp;istream)&nbsp;ostream)))))<br /><br /><br />&nbsp;(translate-cfasl&nbsp;"units/7116/sbhl-modules.cfasl"&nbsp;nil)<br />clet&nbsp;((*fstream*&nbsp;(OPEN-TEXT&nbsp;filestring&nbsp;:input))(kifterm&nbsp;nil)(CYCL&nbsp;nil)(*the-date*&nbsp;(the-date)))<br />&nbsp;&nbsp;<br /><br /><br />|#<br /><br />(define&nbsp;better-symbol&nbsp;(suggest&nbsp;current)&nbsp;(ret<br />&nbsp;&nbsp;&nbsp;(punless&nbsp;suggest&nbsp;(ret&nbsp;current))<br />&nbsp;&nbsp;&nbsp;(punless&nbsp;current&nbsp;(ret&nbsp;suggest))<br />&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(eql&nbsp;suggest&nbsp;current)&nbsp;(ret&nbsp;current))<br />&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(&gt;&nbsp;(symbol-priority&nbsp;suggest)(symbol-priority&nbsp;current))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ret&nbsp;suggest))<br />&nbsp;&nbsp;&nbsp;(ret&nbsp;current)))<br /><br />(define&nbsp;symbol-priority&nbsp;(sym&nbsp;&amp;optional&nbsp;(start&nbsp;1))<br />&nbsp;&nbsp;(pwhen&nbsp;(cor&nbsp;(null&nbsp;sym)(keywordp&nbsp;sym))&nbsp;(ret&nbsp;0))<br />&nbsp;&nbsp;(pwhen&nbsp;(fboundp&nbsp;sym)&nbsp;(cinc&nbsp;start&nbsp;5))<br />&nbsp;&nbsp;(pwhen&nbsp;(boundp&nbsp;sym)&nbsp;(cinc&nbsp;start&nbsp;3))<br />&nbsp;&nbsp;(pwhen&nbsp;(member-if&nbsp;#'(lambda&nbsp;(a)&nbsp;(ret&nbsp;(search&nbsp;a&nbsp;(symbol-name&nbsp;sym))))&nbsp;'("&amp;"&nbsp;"#"&nbsp;"@"&nbsp;"%"&nbsp;"*"&nbsp;"_"))(cinc&nbsp;start&nbsp;1))<br />&nbsp;&nbsp;(ret&nbsp;start))<br /><br />(define&nbsp;xfer-symbol&nbsp;(sym&nbsp;topack&nbsp;&amp;optional&nbsp;(report&nbsp;(eq&nbsp;topack&nbsp;*CYC-PACKAGE*)))<br />&nbsp;&nbsp;&nbsp;&nbsp;(punless&nbsp;sym&nbsp;(ret&nbsp;sym))<br />&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(keywordp&nbsp;sym)&nbsp;(ret&nbsp;sym))<br />&nbsp;&nbsp;&nbsp;&nbsp;(punless&nbsp;(eq&nbsp;topack&nbsp;(symbol-package&nbsp;sym))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(clet&nbsp;((status&nbsp;(multiple-value-list&nbsp;(find-symbol&nbsp;(symbol-name&nbsp;sym)&nbsp;topack)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(found&nbsp;(car&nbsp;status)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fif&nbsp;found<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(punless&nbsp;(eq&nbsp;sym&nbsp;found)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(cor&nbsp;(fboundp&nbsp;sym)(boundp&nbsp;sym))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(clet&nbsp;((foundp&nbsp;(symbol-package&nbsp;found)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(eq&nbsp;foundp&nbsp;topack)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fif&nbsp;(cor&nbsp;(fboundp&nbsp;found)(boundp&nbsp;found))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(progn&nbsp;(terpri)(terpri)&nbsp;(force-print&nbsp;`(in&nbsp;&nbsp;,topack&nbsp;the&nbsp;symbol&nbsp;,found&nbsp;from&nbsp;,foundp&nbsp;is&nbsp;hiding&nbsp;,sym&nbsp;from&nbsp;,(symbol-package&nbsp;sym&nbsp;))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(progn&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(equal&nbsp;(second&nbsp;status)&nbsp;':external)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(terpri)(terpri)(force-print&nbsp;`(unexport&nbsp;,found&nbsp;,foundp))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(unexport&nbsp;found&nbsp;foundp))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(force-print&nbsp;`(inside&nbsp;&nbsp;,topack&nbsp;the&nbsp;symbol&nbsp;,found&nbsp;from&nbsp;,foundp&nbsp;is&nbsp;being&nbsp;replaced&nbsp;with&nbsp;,sym&nbsp;from&nbsp;,(symbol-package&nbsp;sym&nbsp;)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;*greppable-symbols*&nbsp;(remove&nbsp;found&nbsp;*greppable-symbols*))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(with-error-handler&nbsp;#'(lambda&nbsp;())&nbsp;(unintern&nbsp;found&nbsp;topack))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(import&nbsp;sym&nbsp;topack)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(import&nbsp;sym&nbsp;topack)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(terpri)(force-print&nbsp;`(now&nbsp;,(symbol-package&nbsp;(find-symbol&nbsp;(symbol-name&nbsp;sym)&nbsp;topack))))))))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(progn&nbsp;(pwhen&nbsp;report&nbsp;(force-print&nbsp;`(importing&nbsp;,sym))&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(import&nbsp;sym&nbsp;topack)(import&nbsp;sym&nbsp;topack))))))<br /><br />(punless&nbsp;(find-package&nbsp;"EXPORTING")&nbsp;(make-package&nbsp;"EXPORTING"&nbsp;()&nbsp;()))<br />(define&nbsp;sublisp::test1&nbsp;(a)<br />&nbsp;&nbsp;(ret&nbsp;`(test1&nbsp;,a)))<br /><br />(define&nbsp;cyc::test1&nbsp;(a)<br />&nbsp;&nbsp;(ret&nbsp;`(test1&nbsp;,a)))<br /><br /><br />(defvar&nbsp;*total-greppable-symbols*&nbsp;0)<br />(defvar&nbsp;*new-greppable-symbols*&nbsp;:unknown)<br />(defvar&nbsp;*uninterned-greppable-symbols*&nbsp;())<br />(defvar&nbsp;*greppable-symbols*&nbsp;'(()&nbsp;T&nbsp;))<br /><br /><br />(define&nbsp;CHECK-ON-greppable-SYMBOLS&nbsp;(&amp;rest&nbsp;any)<br />&nbsp;&nbsp;(csetq&nbsp;*ERROR-MESSSAGE*&nbsp;NIL)<br />&nbsp;&nbsp;(fresh-line)(format&nbsp;t&nbsp;"known&nbsp;symbols&nbsp;~a&nbsp;~%"&nbsp;(length&nbsp;*greppable-symbols*))(force-output)<br />&nbsp;&nbsp;&nbsp;&nbsp;(CDO-ALL-SYMBOLS&nbsp;(sym)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(xfer-symbol&nbsp;sym&nbsp;(fif&nbsp;(eq&nbsp;*CYC-PACKAGE*&nbsp;(symbol-package&nbsp;sym))&nbsp;*SUBLISP-PACKAGE*&nbsp;*CYC-PACKAGE*))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cpushnew&nbsp;sym&nbsp;*greppable-symbols*))<br />&nbsp;&nbsp;&nbsp;&nbsp;(fresh-line)(format&nbsp;t&nbsp;"sorting&nbsp;symbols&nbsp;~a&nbsp;~%"&nbsp;(length&nbsp;*greppable-symbols*))(force-output)<br />&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;*greppable-symbols*&nbsp;(sort&nbsp;*greppable-symbols*&nbsp;#'SYM&lt;))<br />&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;*total-greppable-symbols*&nbsp;(length&nbsp;*greppable-symbols*))<br />&nbsp;&nbsp;&nbsp;&nbsp;(fresh-line)(format&nbsp;t&nbsp;"found&nbsp;symbols&nbsp;~a&nbsp;~%"&nbsp;*total-greppable-symbols*)(force-output))<br />#|<br />(punless<br />&nbsp;&nbsp;(equal&nbsp;0&nbsp;*new-greppable-symbols*)<br />&nbsp;&nbsp;(format&nbsp;t&nbsp;"~%&nbsp;;;&nbsp;searching&nbsp;for&nbsp;new&nbsp;*greppable-symbols*&nbsp;bacause&nbsp;~s&nbsp;was&nbsp;increased&nbsp;by&nbsp;~s&nbsp;~%"&nbsp;*total-greppable-symbols*&nbsp;*new-greppable-symbols*&nbsp;)(force-output)<br />&nbsp;&nbsp;(csetq&nbsp;*new-greppable-symbols*&nbsp;&nbsp;0)<br />&nbsp;&nbsp;(CDO-ALL-SYMBOLS&nbsp;(sym)&nbsp;(punless&nbsp;(keywordp&nbsp;sym)&nbsp;(pwhen&nbsp;(second&nbsp;(multiple-value-list&nbsp;(insert-sorted&nbsp;sym&nbsp;*greppable-symbols*)))(cinc&nbsp;*new-greppable-symbols*))))<br />&nbsp;&nbsp;(punless&nbsp;(equal&nbsp;0&nbsp;*new-greppable-symbols*)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"~%&nbsp;;;&nbsp;(re)sorting&nbsp;~A&nbsp;*greppable-symbols*&nbsp;after&nbsp;finding&nbsp;~s&nbsp;symbol(s)&nbsp;~%"&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(+&nbsp;*new-greppable-symbols*&nbsp;*total-greppable-symbols*)&nbsp;*new-greppable-symbols*))<br />&nbsp;&nbsp;(force-output)<br />&nbsp;&nbsp;(csetq&nbsp;*total-greppable-symbols*&nbsp;(length&nbsp;*greppable-symbols*))<br />&nbsp;&nbsp;(format&nbsp;t&nbsp;"~%&nbsp;;;&nbsp;symbol&nbsp;count&nbsp;is&nbsp;now:&nbsp;~s&nbsp;~%"&nbsp;*total-greppable-symbols*)(force-output)))<br />&nbsp;&nbsp;|#<br />&nbsp;<br /><br />(define&nbsp;read-from-vstring&nbsp;(str)<br />&nbsp;&nbsp;(ret&nbsp;(and&nbsp;(stringp&nbsp;str)&nbsp;(cnot&nbsp;(empty-string-p&nbsp;str))&nbsp;(read-from-string&nbsp;str))))<br /><br />(defmacro&nbsp;HTML-LABELED-CHECKBOX&nbsp;(KEYWORDS)<br />&nbsp;&nbsp;(clet&nbsp;((named&nbsp;(format&nbsp;nil&nbsp;"~a"&nbsp;KEYWORDS)))&nbsp;(ret<br />&nbsp;&nbsp;&nbsp;&nbsp;`(progn&nbsp;(csetq&nbsp;,KEYWORDS&nbsp;(html-extract-input&nbsp;,named&nbsp;httpvars))<br />&nbsp;&nbsp;&nbsp;&nbsp;(HTML-CHECKBOX-INPUT&nbsp;,named&nbsp;,named&nbsp;,KEYWORDS&nbsp;(format&nbsp;nil&nbsp;"id=~s"&nbsp;,named))<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;label&nbsp;for=\"~a\"&gt;&nbsp;~a&nbsp;&nbsp;&lt;/label&gt;"&nbsp;,named&nbsp;,named)))))<br /><br />(csetq&nbsp;STARTCOUNT&nbsp;0)<br />(csetq&nbsp;FOUNDCOUNT&nbsp;0)<br />(csetq&nbsp;MAXDISPLAYCOUNT&nbsp;500)<br /><br />(define&nbsp;cb-subl-grep-any&nbsp;(httpvars)<br />&nbsp;(clet&nbsp;<br />&nbsp;&nbsp;&nbsp;((*standard-output*&nbsp;*html-stream*)<br />&nbsp;&nbsp;&nbsp;&nbsp;(sym&nbsp;())<br />&nbsp;&nbsp;&nbsp;&nbsp;(search&nbsp;(or&nbsp;(html-extract-input&nbsp;"SEARCH"&nbsp;httpvars)&nbsp;"CB-"))&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;(args&nbsp;(or&nbsp;(html-extract-input&nbsp;"ARGS"&nbsp;httpvars)&nbsp;""))<br />&nbsp;&nbsp;&nbsp;&nbsp;(STARTCOUNT&nbsp;(or&nbsp;(read-from-vstring&nbsp;(html-extract-input&nbsp;"STARTCOUNT"&nbsp;httpvars))&nbsp;STARTCOUNT))<br />&nbsp;&nbsp;&nbsp;&nbsp;(MAXDISPLAYCOUNT&nbsp;(or&nbsp;(read-from-vstring&nbsp;(html-extract-input&nbsp;"MAXDISPLAYCOUNT"&nbsp;httpvars))&nbsp;MAXDISPLAYCOUNT))<br />&nbsp;&nbsp;&nbsp;&nbsp;(KEYWORDS&nbsp;(or&nbsp;(html-extract-input&nbsp;"KEYWORDS"&nbsp;httpvars)&nbsp;NIL))<br />&nbsp;&nbsp;&nbsp;&nbsp;(DETAILED&nbsp;(or&nbsp;(html-extract-input&nbsp;"DETAILED"&nbsp;httpvars)&nbsp;NIL))<br />&nbsp;&nbsp;&nbsp;&nbsp;(symbols&nbsp;(or&nbsp;(html-extract-input&nbsp;"SYMBOLS"&nbsp;httpvars)&nbsp;KEYWORDS))<br />&nbsp;&nbsp;&nbsp;&nbsp;(functions&nbsp;(or&nbsp;(html-extract-input&nbsp;"FUNCTIONS"&nbsp;httpvars)&nbsp;KEYWORDS))<br />&nbsp;&nbsp;&nbsp;&nbsp;(handlers&nbsp;(or&nbsp;(html-extract-input&nbsp;"HANDLER"&nbsp;httpvars)&nbsp;KEYWORDS))<br />&nbsp;&nbsp;&nbsp;&nbsp;(modules&nbsp;(or&nbsp;(html-extract-input&nbsp;"MODULES"&nbsp;httpvars)&nbsp;KEYWORDS))<br />&nbsp;&nbsp;&nbsp;&nbsp;(STARTDISPLAYCOUNT&nbsp;(-&nbsp;STARTCOUNT&nbsp;MAXDISPLAYCOUNT))<br />&nbsp;&nbsp;&nbsp;&nbsp;(DISPLAYCOUNT&nbsp;0)<br />&nbsp;&nbsp;&nbsp;&nbsp;(FOUNDCOUNT&nbsp;0))<br />&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;'-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;Transitional//EN'&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;&lt;/title&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;name='GENERATOR'&nbsp;content='Microsoft&nbsp;Visual&nbsp;Studio&nbsp;.NET&nbsp;7.1'&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;name='vs_targetSchema'&nbsp;content='http://schemas.microsoft.com/intellisense/ie5'&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textarea&nbsp;{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scrollbar-face-color:#fff;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scrollbar-arrow-color:#fff;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scrollbar-highlight-color:#fff;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scrollbar-shadow-color:#fff;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scrollbar-3dlight-color:#fff;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scrollbar-darkshadow-color:#fff;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scrollbar-track-color:#fff;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/HEAD&gt;&lt;BODY&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;border=\"0\"&nbsp;&nbsp;bordercolorlight=\"#3FFFFF\"&nbsp;bordercolordark=\"#FFFFFF\"&nbsp;align=\"left\"&nbsp;cellspacing=\"0\"&nbsp;cellpadding=\"0\"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&lt;th&nbsp;&nbsp;align=\"left\"&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;FORM&nbsp;method='get'&nbsp;action='cg?cb-subl-grep'&gt;&lt;INPUT&nbsp;id='cb-subl-grep'&nbsp;type='hidden'&nbsp;name='cb-subl-grep'&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"search:&nbsp;&lt;input&nbsp;type=text&nbsp;name='SEARCH'&nbsp;value=\"~a\"&gt;"&nbsp;search)<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"args:&nbsp;&lt;input&nbsp;type=text&nbsp;name='ARGS'&nbsp;value=\"~a\"&gt;"&nbsp;args)<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;INPUT&nbsp;id='DO'&nbsp;type='submit'&nbsp;value='GREP'&nbsp;name='DO'&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&nbsp;start:&nbsp;&lt;input&nbsp;type=text&nbsp;name='STARTCOUNT'&nbsp;size=3&nbsp;value=\"~a\"&gt;"&nbsp;(fif&nbsp;(&lt;&nbsp;STARTDISPLAYCOUNT&nbsp;0)&nbsp;0&nbsp;STARTDISPLAYCOUNT))<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&nbsp;max:&nbsp;&lt;input&nbsp;type=text&nbsp;name='MAXDISPLAYCOUNT'&nbsp;size=4&nbsp;value=\"~a\"&gt;&lt;pre&gt;HTTPVARS&nbsp;=&nbsp;~s&lt;BR&gt;"&nbsp;MAXDISPLAYCOUNT&nbsp;httpvars)<br />&nbsp;&nbsp;&nbsp;&nbsp;(HTML-LABELED-CHECKBOX&nbsp;functions)(HTML-LABELED-CHECKBOX&nbsp;handlers)<br />&nbsp;&nbsp;&nbsp;&nbsp;(HTML-LABELED-CHECKBOX&nbsp;MODULES)(HTML-LABELED-CHECKBOX&nbsp;DETAILED)(HTML-LABELED-CHECKBOX&nbsp;symbols)(HTML-LABELED-CHECKBOX&nbsp;KEYWORDS)<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;/form&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;(force-output)<br />&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(cor&nbsp;(empty-string-p&nbsp;search)(cnot&nbsp;(stringp&nbsp;search)))&nbsp;(csetq&nbsp;string&nbsp;nil))<br />&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(cor&nbsp;(empty-string-p&nbsp;args)(cnot&nbsp;(stringp&nbsp;args)))&nbsp;(csetq&nbsp;args&nbsp;nil))<br />&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;modules<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(DO-HL-MODULES&nbsp;(mod)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(clet&nbsp;((sym&nbsp;(HL-MODULE-NAME&nbsp;mod)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cand&nbsp;(cor&nbsp;&nbsp;&nbsp;&nbsp;(null&nbsp;search)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(clet&nbsp;((sname&nbsp;(symbol-name&nbsp;sym))(ssname&nbsp;(cconcatenate&nbsp;"&nbsp;"&nbsp;sname&nbsp;"&nbsp;")))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cand&nbsp;&nbsp;(cor&nbsp;(null&nbsp;search)(search&nbsp;sname&nbsp;search)(search&nbsp;search&nbsp;ssname))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cor&nbsp;(null&nbsp;args)(clet&nbsp;((ssname&nbsp;(write-to-string&nbsp;(MODULE-GET-NAME&nbsp;mod))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cor&nbsp;(search&nbsp;sname&nbsp;args)&nbsp;(search&nbsp;args&nbsp;ssname)))))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&nbsp;&lt;a&nbsp;href='cg?cb-hl-module&amp;:~a'&gt;~s&lt;/a&gt;~%"&nbsp;sym&nbsp;sym)))))<br />&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;/pre&gt;&lt;/th&gt;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&lt;td&gt;&lt;table&nbsp;border=\"0\"&nbsp;&nbsp;bordercolorlight='#FF6FFF'&nbsp;bordercolordark='#FFFF5F'&nbsp;align=left&nbsp;cellspacing='0'&nbsp;cellpadding='0'&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&lt;th&nbsp;align=\"left\"&nbsp;width=\"80px\"&gt;&lt;i&gt;Function&lt;/i&gt;&lt;/th&gt;&lt;th&nbsp;align=\"left\"&nbsp;width=\"430px\"&gt;&lt;i&gt;Symbol&lt;/i&gt;&lt;/th&gt;&lt;th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;align=\"center\"&gt;&lt;i&gt;Arguments&lt;/i&gt;&lt;/p&gt;&lt;/th&gt;&lt;/tr&gt;")<br />&nbsp;&nbsp;(force-output)<br />&nbsp;&nbsp;(pwhen&nbsp;(listp&nbsp;*greppable-symbols*)<br />&nbsp;&nbsp;&nbsp;&nbsp;(cdolist&nbsp;&nbsp;(sym&nbsp;*greppable-symbols*)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(punless&nbsp;(cor&nbsp;(&gt;=&nbsp;DISPLAYCOUNT&nbsp;MAXDISPLAYCOUNT)(member&nbsp;sym&nbsp;'(*greppable-symbols*)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(clet&nbsp;((sname&nbsp;(symbol-name&nbsp;sym))(ssname&nbsp;(cconcatenate&nbsp;"&nbsp;"&nbsp;sname&nbsp;"&nbsp;")))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cand&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cor<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cand&nbsp;functions&nbsp;(fboundp&nbsp;sym)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cor&nbsp;(null&nbsp;search)(search&nbsp;search&nbsp;ssname))&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cor&nbsp;(null&nbsp;args)(search&nbsp;sname&nbsp;args)(search&nbsp;args&nbsp;ssname)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cand&nbsp;handlers&nbsp;(HTML-HANDLER-FUNCTION?&nbsp;sym)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cor&nbsp;(null&nbsp;search)(search&nbsp;search&nbsp;ssname))&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cor&nbsp;(null&nbsp;args)(search&nbsp;sname&nbsp;args)(search&nbsp;args&nbsp;ssname)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cand&nbsp;keywords&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cor&nbsp;(null&nbsp;search)(search&nbsp;search&nbsp;ssname))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cor&nbsp;(null&nbsp;args)(search&nbsp;sname&nbsp;args)(search&nbsp;args&nbsp;ssname)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cand&nbsp;symbols&nbsp;(boundp&nbsp;sym)&nbsp;(cnot&nbsp;(keywordp&nbsp;sym))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cor&nbsp;(onerror-warn&nbsp;"unkownn"&nbsp;&nbsp;(pwhen&nbsp;(symbol-value&nbsp;sym)&nbsp;(csetq&nbsp;ssname&nbsp;(write-to-string&nbsp;(symbol-value&nbsp;sym)))))&nbsp;T)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cor&nbsp;(null&nbsp;search)(search&nbsp;search&nbsp;ssname))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cor&nbsp;(null&nbsp;args)(search&nbsp;sname&nbsp;args)(search&nbsp;args&nbsp;ssname))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(onerror-warn&nbsp;"unkownn"&nbsp;&nbsp;(cinc&nbsp;FOUNDCOUNT))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(&gt;&nbsp;FOUNDCOUNT&nbsp;STARTCOUNT)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cinc&nbsp;DISPLAYCOUNT)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(onerror-warn&nbsp;"unkownn"&nbsp;(html-symbol-apropos&nbsp;sym&nbsp;detailed))))))))<br />;;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(onerror-warn&nbsp;"unkownn"&nbsp;&nbsp;(&lt;=&nbsp;(CDEC&nbsp;STARTCOUNT)&nbsp;0))&nbsp;(pwhen&nbsp;&nbsp;(onerror-warn&nbsp;"unkownn"&nbsp;&nbsp;(&lt;&nbsp;0&nbsp;MAXDISPLAYCOUNT))(onerror-warn&nbsp;"unkownn"&nbsp;&nbsp;(cdec&nbsp;MAXDISPLAYCOUNT))))))<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&nbsp;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;FORM&nbsp;method='get'&nbsp;action='cg?cb-subl-grep'&gt;&lt;INPUT&nbsp;id='cb-subl-grep'&nbsp;type='hidden'&nbsp;name='cb-subl-grep'&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"search:&nbsp;&lt;input&nbsp;type=text&nbsp;name='SEARCH'&nbsp;value=\"~a\"&gt;"&nbsp;(fif&nbsp;search&nbsp;search&nbsp;""))<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"args:&nbsp;&lt;input&nbsp;type=text&nbsp;name='ARGS'&nbsp;value=\"~a\"&gt;"&nbsp;(fif&nbsp;&nbsp;args&nbsp;&nbsp;args&nbsp;""))<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;INPUT&nbsp;id='DO'&nbsp;type='submit'&nbsp;value='GREP'&nbsp;name='DO'&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&nbsp;start:&nbsp;&lt;input&nbsp;type=text&nbsp;name='STARTCOUNT'&nbsp;size=3&nbsp;value=\"~a\"&gt;"&nbsp;&nbsp;FOUNDCOUNT&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&nbsp;max:&nbsp;&lt;input&nbsp;type=text&nbsp;name='MAXDISPLAYCOUNT'&nbsp;size=4&nbsp;value=\"~a\"&gt;&lt;pre&gt;&lt;BR&gt;"&nbsp;MAXDISPLAYCOUNT)<br />&nbsp;&nbsp;&nbsp;&nbsp;(HTML-LABELED-CHECKBOX&nbsp;functions)(HTML-LABELED-CHECKBOX&nbsp;handlers)<br />&nbsp;&nbsp;&nbsp;&nbsp;(HTML-LABELED-CHECKBOX&nbsp;MODULES)(HTML-LABELED-CHECKBOX&nbsp;DETAILED)(HTML-LABELED-CHECKBOX&nbsp;symbols)(HTML-LABELED-CHECKBOX&nbsp;KEYWORDS)<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;/form&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;(force-output)(ret&nbsp;httpvars)))<br /><br />(define&nbsp;safe-mapcar&nbsp;(fun&nbsp;list)<br />&nbsp;&nbsp;(pwhen&nbsp;(cand&nbsp;list&nbsp;fun)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cdolist&nbsp;(e&nbsp;list)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(funcall&nbsp;fun&nbsp;e))))<br /><br />(define&nbsp;html-object-details&nbsp;(obj&nbsp;&amp;optional&nbsp;(class&nbsp;(type-of&nbsp;obj))&nbsp;depth)<br />&nbsp;(punless&nbsp;obj&nbsp;(ret&nbsp;class))<br />&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(symbolp&nbsp;obj)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(html-object-details&nbsp;(CLASSES-RETRIEVE-CLASS&nbsp;obj))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ret&nbsp;(html-symbol-apropos&nbsp;obj&nbsp;nil)))<br />&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(CLASS-P&nbsp;obj)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(clet&nbsp;((class&nbsp;obj)(obj&nbsp;(CLASS-NAME&nbsp;class)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;TR&gt;&lt;TD&gt;&lt;pre&gt;CLASS:~%~a&lt;/pre&gt;&lt;/TD&gt;&lt;TD&gt;&lt;PRE&gt;"&nbsp;obj)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;/PRE&gt;&lt;/TD&gt;&lt;TD&gt;&lt;PRE&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(display-class&nbsp;class)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;/PRE&gt;&lt;/TD&gt;&lt;/TR&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;TR&gt;&lt;TD&gt;&lt;pre&gt;SUBCLASSES&lt;/pre&gt;&lt;/TD&gt;&lt;TD&gt;&lt;PRE&gt;~a"&nbsp;obj)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;/PRE&gt;&lt;/TD&gt;&lt;TD&gt;")<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cdolist&nbsp;(sclass&nbsp;(sort&nbsp;(CLASSES-FIND-ALL-SUBCLASSES&nbsp;class&nbsp;nil)&nbsp;#'sym&lt;))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;a&nbsp;href='cg?cb-subloop-class&amp;CLASS=~s'&gt;~s&lt;/a&gt;&nbsp;"&nbsp;sclass&nbsp;sclass))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;/TD&gt;&lt;/TR&gt;")))<br />&nbsp;&nbsp;&nbsp;(ret&nbsp;nil))<br /><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />(define&nbsp;html-symbol-apropos&nbsp;(sym&nbsp;&amp;optional&nbsp;detailed)<br />&nbsp;(pwhen&nbsp;detailed&nbsp;(ret&nbsp;(html-object-details&nbsp;sym)))<br />&nbsp;(clet&nbsp;((shown&nbsp;nil))<br />&nbsp;&nbsp;(pwhen&nbsp;(boundp&nbsp;sym)&nbsp;(html-form-statement-cgi&nbsp;'CSETQ&nbsp;sym&nbsp;(quotify&nbsp;(symbol-value&nbsp;sym)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;shown&nbsp;'CSETQ))<br />&nbsp;&nbsp;(pwhen&nbsp;(HTML-HANDLER-FUNCTION?&nbsp;sym)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(html-form-statement-cgi&nbsp;'HTTPY&nbsp;sym&nbsp;(FUNCTION-symbol-ARGLIST&nbsp;sym))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;shown&nbsp;'HTTPY))<br />&nbsp;&nbsp;(pwhen&nbsp;(fboundp&nbsp;sym)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;(punless&nbsp;(eq&nbsp;shown&nbsp;'HTTPY)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(html-form-statement-cgi&nbsp;'APPLY&nbsp;sym&nbsp;(FUNCTION-symbol-ARGLIST&nbsp;sym))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;shown&nbsp;'APPLY)))<br />&nbsp;&nbsp;(punless&nbsp;shown<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(html-form-statement-cgi&nbsp;'SYM&nbsp;sym&nbsp;(cons&nbsp;(SYMBOL-PACKAGE&nbsp;sym)&nbsp;(multiple-value-list&nbsp;(find-symbol&nbsp;(symbol-name&nbsp;sym)&nbsp;(SYMBOL-PACKAGE&nbsp;sym))))))<br />&nbsp;&nbsp;(ret&nbsp;shown)))<br /><br />(define&nbsp;html-form-statement-cgi&nbsp;(id&nbsp;sym&nbsp;infoS)<br />&nbsp;&nbsp;(clet&nbsp;((sname&nbsp;(write-to-string&nbsp;sym)))<br />&nbsp;&nbsp;(format&nbsp;t&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;"&lt;FORM&nbsp;method='get'&nbsp;action='cg?cb-subl-grep'&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;INPUT&nbsp;id='cb-subl-grep'&nbsp;type='hidden'&nbsp;name='cb-subl-grep'&nbsp;value='~a'&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;INPUT&nbsp;id='cb-subl-grep'&nbsp;type='hidden'&nbsp;name='~a'&nbsp;value='~a'&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&lt;td&gt;(~a&lt;/td&gt;&lt;td&gt;~a&lt;/td&gt;&lt;td&gt;"<br />&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;id&nbsp;sym&nbsp;id&nbsp;sname)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(pcase&nbsp;id<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((APPLY&nbsp;FUNCALL&nbsp;HTTPY)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(onerror-warn&nbsp;(format&nbsp;nil&nbsp;"(html-form-statement-cgi&nbsp;~a&nbsp;~a&nbsp;...)"&nbsp;id&nbsp;sym)&nbsp;(html-value-caller-form-element&nbsp;sym&nbsp;infoS)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(otherwise<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(onerror-warn&nbsp;(format&nbsp;nil&nbsp;"(html-form-statement-cgi&nbsp;~a&nbsp;~a&nbsp;...)"&nbsp;id&nbsp;sym)&nbsp;(html-value-setter-form-element&nbsp;sym&nbsp;infoS))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;")&lt;/td&gt;&lt;/tr&gt;&lt;/form&gt;")))<br /><br />(define&nbsp;html-value-caller-form-element&nbsp;(sym&nbsp;infoS)<br />&nbsp;&nbsp;(pwhen&nbsp;(consp&nbsp;infoS)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;infoS&nbsp;(remove&nbsp;'&amp;OPTIONAL&nbsp;infoS))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;infoS&nbsp;(remove&nbsp;'&amp;REST&nbsp;infoS))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;infoS&nbsp;(write-to-string&nbsp;infoS))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;infoS&nbsp;(substring&nbsp;infoS&nbsp;1&nbsp;(-&nbsp;(length&nbsp;infoS)&nbsp;1))))<br />&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;INPUT&nbsp;type=text&nbsp;style='WIDTH:&nbsp;800px'&nbsp;NAME=\"~a\"&nbsp;value=\"~a\"&gt;"&nbsp;&nbsp;sym&nbsp;infoS))<br /><br />(define&nbsp;html-value-setter-form-element&nbsp;(sym&nbsp;infoS)<br />&nbsp;&nbsp;&nbsp;(pcond&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((equal&nbsp;T&nbsp;infoS)&nbsp;;;&nbsp;True/False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;SELECT&nbsp;style='WIDTH:&nbsp;800px'&nbsp;id=\"~a\"&nbsp;&nbsp;name=\"~a\"&nbsp;size='1'&gt;"&nbsp;sym&nbsp;sym)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;OPTION&nbsp;value='T'&gt;T&lt;/OPTION&gt;&lt;option&nbsp;value='NIL'&gt;NIL&lt;/option&gt;&lt;/SELECT&gt;"))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((stringp&nbsp;infoS)&nbsp;;;&nbsp;Strings<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;input&nbsp;style='WIDTH:&nbsp;800px'&nbsp;&nbsp;type=text&nbsp;&nbsp;NAME=\"~a\"&nbsp;id=\"~a\"&nbsp;value=\"~a\"&gt;"&nbsp;sym&nbsp;sym&nbsp;(HTML-ENCODE-TEXT&nbsp;(write-to-string&nbsp;infoS))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((unreadable-p&nbsp;infoS)&nbsp;;;&nbsp;Ugly&nbsp;objects&nbsp;(offer&nbsp;T/NIL)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;SELECT&nbsp;style='WIDTH:&nbsp;800px'&nbsp;id=\"~a\"&nbsp;&nbsp;name=\"~a\"&nbsp;size='1'&gt;"&nbsp;sym&nbsp;sym)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;option&nbsp;value=\"~a\"&nbsp;selected&gt;~a&lt;/option&gt;&lt;option&nbsp;value='NIL'&gt;NIL&lt;/option&gt;&lt;OPTION&nbsp;value='T'&gt;T&lt;/OPTION&gt;&lt;/SELECT&gt;"&nbsp;(HTML-ENCODE-TEXT&nbsp;(write-to-string&nbsp;infoS))&nbsp;(HTML-ENCODE-TEXT&nbsp;(write-to-string&nbsp;infoS))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(t&nbsp;&nbsp;;;&nbsp;Re-readables<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;input&nbsp;style='WIDTH:&nbsp;800px'&nbsp;type=text&nbsp;&nbsp;NAME=\"~a\"&nbsp;id=\"~a\"&nbsp;value=\"~a\"&gt;"&nbsp;sym&nbsp;sym&nbsp;(HTML-ENCODE-TEXT&nbsp;(write-to-string&nbsp;infoS))))))<br /><br />;;(ret&nbsp;(equal&nbsp;obj&nbsp;(read-from-string&nbsp;(write-to-string&nbsp;obj)))))<br />(define&nbsp;unREADABLE-P&nbsp;(obj&nbsp;&amp;optional&nbsp;(depth&nbsp;10))<br />&nbsp;&nbsp;(pwhen&nbsp;(cand&nbsp;(consp&nbsp;obj)&nbsp;(&gt;&nbsp;depth&nbsp;0))<br />&nbsp;&nbsp;&nbsp;&nbsp;(ret&nbsp;(cor&nbsp;(unREADABLE-P&nbsp;(car&nbsp;obj)&nbsp;(-&nbsp;depth&nbsp;1))(unREADABLE-P&nbsp;(cdr&nbsp;obj)&nbsp;(-&nbsp;depth&nbsp;1)))))<br />&nbsp;&nbsp;(ret&nbsp;(cnot&nbsp;(readable-p&nbsp;obj))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><br />&nbsp;;;(setq&nbsp;unre&nbsp;'(1&nbsp;.&nbsp;2))&nbsp;(rplaca&nbsp;unre&nbsp;unre&nbsp;)<br /><br /><br />;;http://subl.cycipedia.com/openCycCGI/cg?cb-start|cb-subl-grep&amp;search=PARSER<br />(define-cb-link-method&nbsp;:current-cb-subl-grep&nbsp;(&amp;optional&nbsp;linktext)<br />&nbsp;&nbsp;(punless&nbsp;linktext&nbsp;(csetq&nbsp;linktext&nbsp;"Grep&nbsp;for&nbsp;SubL&nbsp;Code"))<br />&nbsp;&nbsp;(frame-link&nbsp;(html-princ&nbsp;"cb-subl-grep")&nbsp;(html-princ&nbsp;linktext))<br />&nbsp;&nbsp;(ret&nbsp;nil))<br /><br />(declare-cb-tool&nbsp;:current-cb-subl-grep&nbsp;"Grep&nbsp;for&nbsp;SubL&nbsp;Code"&nbsp;"All&nbsp;httpd"&nbsp;"Grep&nbsp;for&nbsp;SubL")<br /><br /><br />(define&nbsp;my-apply&nbsp;(fn&nbsp;rest)<br />&nbsp;&nbsp;(punless&nbsp;rest<br />&nbsp;&nbsp;&nbsp;(ret&nbsp;(funcall&nbsp;(function&nbsp;CMDCALL))))<br />&nbsp;&nbsp;(clet&nbsp;((argv&nbsp;(FUNCTION-symbol-ARGLIST&nbsp;cmdcall))(argc&nbsp;(length&nbsp;argv)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(pcond<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((onerror-warn&nbsp;"unkownn"&nbsp;&nbsp;(=&nbsp;argc&nbsp;1))&nbsp;(ret&nbsp;(funcall&nbsp;(function&nbsp;CMDCALL)&nbsp;(list&nbsp;rest))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((onerror-warn&nbsp;"unkownn"&nbsp;&nbsp;(=&nbsp;argc&nbsp;1))&nbsp;(ret&nbsp;(funcall&nbsp;(function&nbsp;CMDCALL)&nbsp;(list&nbsp;rest))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((onerror-warn&nbsp;"unkownn"&nbsp;&nbsp;(=&nbsp;argc&nbsp;2))(ret&nbsp;(funcall&nbsp;(function&nbsp;CMDCALL)&nbsp;(list&nbsp;rest))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(t&nbsp;&nbsp;(ret&nbsp;(funcall&nbsp;(function&nbsp;CMDCALL)&nbsp;rest))))))<br /><br /><br /><br /><br />(define&nbsp;export-handler&nbsp;(cmdname)<br />&nbsp;(clet&nbsp;<br />&nbsp;&nbsp;((cmdcall&nbsp;cmdname)<br />&nbsp;&nbsp;&nbsp;(WRAPPER&nbsp;(intern&nbsp;(make-symbol&nbsp;(format&nbsp;nil&nbsp;"~s-WRAPPERX"&nbsp;CMDCALL))))<br />&nbsp;&nbsp;&nbsp;(WRAPPER-KW&nbsp;(make-keyword&nbsp;(format&nbsp;nil&nbsp;"~s-WRAPPERX"&nbsp;CMDCALL)))&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;(HANDLER&nbsp;(intern&nbsp;(make-symbol&nbsp;(format&nbsp;nil&nbsp;"~s-HANDLERX"&nbsp;CMDCALL))))<br />&nbsp;&nbsp;&nbsp;(argStr&nbsp;(list&nbsp;CMDCALL&nbsp;'httpvars)))<br />&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(fboundp&nbsp;CMDCALL)&nbsp;(csetq&nbsp;argStr&nbsp;(cons&nbsp;CMDCALL&nbsp;(FUNCTION-symbol-ARGLIST&nbsp;CMDCALL))))<br />&nbsp;(eval&nbsp;`(progn<br />&nbsp;&nbsp;&nbsp;(print&nbsp;(list&nbsp;',CMDCALL&nbsp;',WRAPPER&nbsp;',WRAPPER-KW&nbsp;',HANDLER&nbsp;))<br />&nbsp;&nbsp;&nbsp;&nbsp;(define-html-handler&nbsp;,HANDLER&nbsp;(rest)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(clet&nbsp;((*standard-output*&nbsp;*html-stream*))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&lt;html&gt;&lt;head&gt;&lt;title&gt;~s&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;~s&lt;/h1&gt;"&nbsp;,(format&nbsp;nil&nbsp;"Running&nbsp;~s"&nbsp;CMDCALL),(format&nbsp;nil&nbsp;"Running&nbsp;~s"&nbsp;CMDCALL))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(with-error-handler&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#'(lambda&nbsp;(&amp;rest&nbsp;errinfo)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;pre&gt;ERROR:&nbsp;~s&nbsp;~s&nbsp;~s&nbsp;~%&lt;/pre&gt;"&nbsp;*ERROR-MESSAGE*&nbsp;,(quotify&nbsp;argStr)&nbsp;errinfo&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(force-output)(ret&nbsp;(car&nbsp;errinfo)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(print&nbsp;(my-apply&nbsp;,(quotify&nbsp;CMDCALL)&nbsp;rest)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;/body&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;")))&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;(define-cb-link-method&nbsp;,WRAPPER-KW&nbsp;(&amp;optional&nbsp;linktext)&nbsp;(punless&nbsp;linktext&nbsp;(csetq&nbsp;linktext&nbsp;,(format&nbsp;nil&nbsp;"~s"&nbsp;WRAPPER-KW)))&nbsp;(frame-link&nbsp;(html-princ&nbsp;,(format&nbsp;nil&nbsp;"~s"&nbsp;HANDLER))&nbsp;(html-princ&nbsp;linktext))(ret&nbsp;nil))&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;(declare-cb-tool&nbsp;,WRAPPER-KW&nbsp;,(format&nbsp;nil&nbsp;"~s"&nbsp;CMDCALL)&nbsp;,(format&nbsp;nil&nbsp;"~s"&nbsp;CMDCALL)&nbsp;,(format&nbsp;nil&nbsp;"Call&nbsp;~s"&nbsp;argStr))<br />&nbsp;&nbsp;&nbsp;&nbsp;(define&nbsp;,WRAPPER&nbsp;(&amp;optional&nbsp;linktext)&nbsp;(cb-link&nbsp;,WRAPPER-KW&nbsp;linktext)&nbsp;(ret&nbsp;nil))))))<br /><br /><br />'(progn&nbsp;(macroexpand-1&nbsp;'(EXPORT-HANDLER&nbsp;CB-HL-MODULE-SUMMARY)))<br />;;#$expansion&nbsp;#$ParserMadLibsFn&nbsp;(#$EvaluateSubLFn&nbsp;(#$ExpandSubLFn&nbsp;(NIL)&nbsp;(RTP-GENERATE-MADLIBS&nbsp;':ARG1&nbsp;':ARG2)))):#$TemplateParsingMt<br /><br />;;&nbsp;'(clet&nbsp;((sym&nbsp;())(pack&nbsp;()))<br />;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cdolist&nbsp;(pack&nbsp;(LIST-ALL-PACKAGES))<br />;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CDO-all-SYMBOLS&nbsp;(sym)<br />;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(fboundp&nbsp;sym)<br />;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(punless<br />;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(search&nbsp;"ERX"&nbsp;(symbol-name&nbsp;sym))<br />;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(EXPORT-HANDLER&nbsp;sym)<br />;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;a&nbsp;href='cg?~s-HANDLERX'&gt;~s&lt;/a&gt;&lt;br&gt;"&nbsp;&nbsp;sym&nbsp;(cons&nbsp;sym&nbsp;(FUNCTION-symbol-ARGLIST&nbsp;sym&nbsp;&nbsp;)))<br />;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(export&nbsp;sym&nbsp;pack))))))<br /><br /><br />(define-html-handler&nbsp;cb-subl-grep&nbsp;(httpvars)<br />&nbsp;(pwhen&nbsp;(probe-file&nbsp;"/cyc/top/subl-grep.lisp")(load&nbsp;"/cyc/top/subl-grep.lisp"))<br />&nbsp;(cb-subl-grep-any&nbsp;httpvars))<br /><br />(define-html-handler&nbsp;cb-any&nbsp;(httpvars)<br />&nbsp;(cb-subl-grep-any&nbsp;httpvars))<br />&nbsp;<br />#|<br />Warning:&nbsp;A&nbsp;SYMBOL&nbsp;at&nbsp;0x402c2434&nbsp;is&nbsp;not&nbsp;a&nbsp;structurep.<br />Warning:&nbsp;#$isa&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;sbhl-predicate-p<br />Warning:&nbsp;A&nbsp;SYMBOL&nbsp;at&nbsp;0x4001001c&nbsp;is&nbsp;not&nbsp;a&nbsp;structurep.<br />Warning:&nbsp;#$isa&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;sbhl-predicate-p<br />Warning:&nbsp;A&nbsp;SYMBOL&nbsp;at&nbsp;0x4001001c&nbsp;is&nbsp;not&nbsp;a&nbsp;structurep.<br />Warning:&nbsp;#$isa&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;sbhl-predicate-p<br />Warning:&nbsp;A&nbsp;SYMBOL&nbsp;at&nbsp;0x4001001c&nbsp;is&nbsp;not&nbsp;a&nbsp;structurep.<br />Warning:&nbsp;#$isa&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;sbhl-predicate-p<br />Warning:&nbsp;A&nbsp;SYMBOL&nbsp;at&nbsp;0x4001001c&nbsp;is&nbsp;not&nbsp;a&nbsp;structurep.<br />Warning:&nbsp;#$genlPreds&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;sbhl-predicate-p<br />Warning:&nbsp;A&nbsp;SYMBOL&nbsp;at&nbsp;0x4001001c&nbsp;is&nbsp;not&nbsp;a&nbsp;structurep.<br />Warning:&nbsp;#$genlPreds&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;sbhl-predicate-p<br />Warning:&nbsp;A&nbsp;SYMBOL&nbsp;at&nbsp;0x4001001c&nbsp;is&nbsp;not&nbsp;a&nbsp;structurep.<br />|#<br /><br /><br />(declare-cb-tool&nbsp;:current-cb-subloop-class&nbsp;"Subloop&nbsp;Interface"&nbsp;"subloop"&nbsp;"Current&nbsp;subloop&nbsp;Interface")<br /><br />(define-cb-link-method&nbsp;:current-cb-subloop-class&nbsp;(&amp;optional&nbsp;linktext)<br />&nbsp;(punless&nbsp;linktext<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;linktext&nbsp;"subloop"))<br />&nbsp;(frame-link<br />&nbsp;&nbsp;(html-princ&nbsp;"cb-subloop-class")<br />&nbsp;&nbsp;(html-princ&nbsp;linktext))<br />&nbsp;(ret&nbsp;nil))<br /><br />(cpushnew&nbsp;'("cb-start|cb-subloop-class"&nbsp;.&nbsp;"subloop")&nbsp;*MAIN-MENU-LIST*&nbsp;#'EQUAL&nbsp;)<br />(define&nbsp;current-cb-subloop-class&nbsp;(&amp;optional&nbsp;linktext)&nbsp;(cb-link&nbsp;:current-cb-smartworld&nbsp;linktext)&nbsp;(ret&nbsp;nil))<br /><br />(csetq&nbsp;*OBJECT-CLASS*&nbsp;(CLASSES-RETRIEVE-CLASS&nbsp;'object))<br /><br />(define&nbsp;mexpand&nbsp;(code)<br />&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;code&nbsp;(macroexpand&nbsp;code))<br />&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(cand&nbsp;(consp&nbsp;code)(consp&nbsp;(cdr&nbsp;code)))&nbsp;(csetq&nbsp;code&nbsp;(cons&nbsp;(car&nbsp;code)(safe-mapcar&nbsp;#'mexpand&nbsp;(cdr&nbsp;code)))))<br />&nbsp;&nbsp;&nbsp;&nbsp;(ret&nbsp;code))<br /><br />#|<br />(defvar&nbsp;*all-struct-types*&nbsp;())<br />(define&nbsp;all-struct-types&nbsp;()<br />&nbsp;&nbsp;&nbsp;&nbsp;(cdo-all-symbols&nbsp;(sym)&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(clet&nbsp;(sv(sn&nbsp;(symbol-name&nbsp;sym))(l&nbsp;(length&nbsp;sn)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(onerror-warn&nbsp;"unkownn"&nbsp;&nbsp;(cand&nbsp;(&gt;&nbsp;l&nbsp;6)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(boundp&nbsp;sym)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(char=&nbsp;(char&nbsp;sn&nbsp;(-&nbsp;l&nbsp;1))&nbsp;#\*)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(equal&nbsp;"*DTP-"&nbsp;(substring&nbsp;sn&nbsp;0&nbsp;5)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;sn&nbsp;(substring&nbsp;sn&nbsp;5&nbsp;(-&nbsp;l&nbsp;1)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(csetq&nbsp;sv&nbsp;(symbol-value&nbsp;sym))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fif&nbsp;(numberp&nbsp;sv)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cpushnew&nbsp;sym&nbsp;*all-struct-types*)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fif&nbsp;(cand&nbsp;(symbolp&nbsp;sv)(equal&nbsp;sn&nbsp;(symbol-name&nbsp;sv)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cpushnew&nbsp;sym&nbsp;*all-struct-types*))))))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ret&nbsp;*all-struct-types*))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;(cpushnew&nbsp;(cons&nbsp;sn&nbsp;sym)&nbsp;*all-struct-types*&nbsp;#'equal)))))))<br /><br />(ALL-STRUCT-TYPES)<br />|#<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />(define-html-handler&nbsp;cb-subloop-class&nbsp;(httpvars)<br />&nbsp;;;(load&nbsp;"&nbsp;(load&nbsp;"/cyc/top/cb-prolog.lisp")<br />&nbsp;&nbsp;(clet&nbsp;((*standard-output*&nbsp;*html-stream*)(read-error&nbsp;NIL)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(class&nbsp;(html-extract-input&nbsp;"CLASS"&nbsp;httpvars)))<br />&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(stringp&nbsp;class)&nbsp;(csetq&nbsp;class&nbsp;(read-from-string&nbsp;class)))<br />&nbsp;&nbsp;&nbsp;(pwhen&nbsp;&nbsp;(symbolp&nbsp;class)&nbsp;(CLASSES-RETRIEVE-CLASS&nbsp;class)&nbsp;(csetq&nbsp;class&nbsp;(CLASSES-RETRIEVE-CLASS&nbsp;class)))<br />&nbsp;&nbsp;&nbsp;(punless&nbsp;(class-p&nbsp;class)&nbsp;(csetq&nbsp;class&nbsp;*OBJECT-CLASS*))<br />&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;SUBLOOP&nbsp;CLASS:~s&lt;/TITLE&gt;&lt;META&nbsp;NAME='GENERATOR'&nbsp;Content='Microsoft&nbsp;Visual&nbsp;Studio&nbsp;.NET&nbsp;8.0'&gt;&lt;/HEAD&gt;&lt;BODY&gt;"&nbsp;class)<br /><br />&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;PRE&gt;~%")<br />&nbsp;&nbsp;&nbsp;(cdolist&nbsp;(sclass&nbsp;(safe-mapcar&nbsp;#'CLASSES-RETRIEVE-CLASS&nbsp;(cons&nbsp;(class-parent&nbsp;class)&nbsp;(sort&nbsp;(CLASSES-FIND-ALL-SUBCLASSES&nbsp;class&nbsp;nil)&nbsp;#'sym&lt;))))<br />&nbsp;&nbsp;&nbsp;&nbsp;(pwhen&nbsp;(class-p&nbsp;sclass)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;a&nbsp;href='cg?cb-subloop-class&amp;CLASS=~s'&gt;~s&lt;/a&gt;&amp;nbsp&nbsp;"&nbsp;(class-name&nbsp;sclass)(class-name&nbsp;sclass))))<br />&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"~%")<br />&nbsp;&nbsp;&nbsp;(display-class&nbsp;class)<br />&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"&lt;/PRE&gt;")<br />&nbsp;&nbsp;&nbsp;(format&nbsp;t&nbsp;"DebugInfo:&lt;pre&gt;HTTPVARS&nbsp;=&nbsp;~s&lt;/pre&gt;&lt;/BODY&gt;&lt;/HTML&gt;"httpvars)))<br /><br />;;(lisp)<br />(csetq&nbsp;*AVAILABLE-CYCLIFICATION-PARSERS*&nbsp;(GET-CYCLIFICATION-PARSERS))<br />(pwhen&nbsp;(fboundp&nbsp;'CHECK-ON-GREPPABLE-SYMBOLS)&nbsp;(defvar&nbsp;*CHECK-ON-GREPPABLE-SYMBOLS-PROCESS*&nbsp;(print&nbsp;(MAKE-PROCESS-WITH-ARGS&nbsp;"CHECK-ON-GREPPABLE-SYMBOLS"&nbsp;#'CHECK-ON-GREPPABLE-SYMBOLS))))<br /><br />(force-print&nbsp;'(load&nbsp;"/cyc/top/subl-grep.lisp"))<br /><br /></span>
</code>